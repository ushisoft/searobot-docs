# 地图相关操作

## 建图

1. 点击APP首页上方的 ![](/images/media/image58.png) 弹出遥控窗口后，通过右侧的遥控手柄将机器人开到合适的位置

2. 点击 ![](/images/media/image7.png) 建图图标
   ![选择地图](/images/media/image8.png)

3. 进入到【选择地图】功能界面，点击右上角【建图】
   ![建图](/images/media/image9.png)

4. 跳转到【创建地图】功能界面
   ![创建地图](/images/media/image10.png)

5. 点击【开始建图】，进入建图初始化界面。地图上外围红色点为激光点数据；开始扫描时机器人的起始位置将记录为地图的原点
   ![建图初始化](/images/media/image11.png)

6. 通过界面上的遥控器遥控机器人行走，机器人会通过激光自动生成行走环境的地图界面
   - 控制机器人走完需要扫描的环境时，点击遥控界面中间的停止按钮
   - 点击界面右上角【保存】按钮，并输入地图名字（英文字母和数字）
   ![保存地图](/images/media/image12.png)

7. 建好的图中，深蓝色表示激光扫描时反馈的障碍物，浅蓝色表示激光未扫描区域，白色表示无障碍，灰色线条表示激光扫描时反馈的路沿（仅3D激光建图时有）
   ![建图效果](/images/media/image13.png)

## 建图录点

建图录点功能可以在建图过程中进行录制点，录制的点可用于导航、定位、绘制轨道。该功能目前只适用于3D激光。

1. 在APP首页，点击 ![](/images/media/image7.png) 进入到【选择地图】界面，点击右上角【建图】按钮，跳转到【创建地图】功能界面

2. 点击【开始建图】，通过遥控器控制机器人行走，在需要录点的地方将机器人停下

3. 点击【录初始点】，输入点名称后确定
   ![录初始点](/images/media/image14.png)

::: tip 提示
此功能只对于3D激光有效，并且录的点与点之间可以正常连接起来。通过录制点连接来绘制轨道将更为准确。
:::

## 继续建图（暂未开放）

继续建图是指可以在原始地图的基础上进行继续建图，需要先把机器人移动到继续建图时的初始位置。注：该功能仅限于2D环境。

## 建图规则及建议

1. 建图必须走一个完整的回环，即建图时机器人行走路径要形成一个完整闭环
2. 分叉路多和环路多的环境，要先闭小环后闭大环
3. 建图起始点尽量不要旋转
4. 结束点选择在之前走过的路径上，且在结束点也尽量不旋转
5. 操作人员尽量站在机器人后方
6. 其它相关人员在建图时尽量不要站在机器人前方，否则建图时容易将其当做固定障碍物添加到地图
7. 转弯地方尽量慢点旋转，能直线行走尽量选择直线
8. 在建图时如果是使用3D建图需要在系统更新里面修改建图环境参数0（室内）和1（室外）

## 编辑虚拟墙

编辑虚拟墙功能用于对地图功能区进行管理，使机器人导航到对应功能区后进行对应的操作。

1. 在APP首页，点击 ![](/images/media/image7.png) 进入到【选择地图】功能界面，点击右侧【编辑】按钮
   ![选择地图编辑](/images/media/image15.png)

2. 进入【编辑地图】功能界面
   ![编辑地图](/images/media/image16.png)

3. 选择【编辑虚拟墙】，进入编辑虚拟墙主界面
   ![编辑虚拟墙](/images/media/image17.png)

4. 虚拟墙类型选择：
   - **虚拟墙**：设置一道虚拟的屏障，让机器人不会通过该区域
   - **坡道**：机器人导航到该区域前会减速
   - **十字路口**：机器人行驶到该区域会对红绿灯进行检测
   - **减速区**：机器人导航到该区域时进行减速
   - **不避障区**：机器人导航到该区域时，若遇到障碍物会停止，但不会进行避障绕行
   - **避障区**：机器人导航到该区域时，会将该区域视为障碍物，进行避障绕行

5. 绘制虚拟墙的方式：
   - **直线**：在地图上确定直线的起点和终点
     ![直线虚拟墙](/images/media/image18.png)
   - **多边形**：在地图上确定多边形的多个顶点
   - **矩形**：在地图上确定矩形的两个对角点
   - **圆形**：在地图上确定圆形的圆心，拖动地图确定圆形的半径

6. 添加其他类型的功能区：
   - 选择模式为坡道、十字路口或减速区时，在地图上确定多边形的多个顶点即可
   ![多种类型功能区](/images/media/image19.png)

7. 删除虚拟墙：
   - 点击选中虚拟墙(选中后为绿色)，再点击右上角的删除按钮
   ![删除虚拟墙](/images/media/image20.png)

## 编辑障碍物

由于建图时可能会有地图噪点或有些障碍物无法识别，可以对地图进行清除噪点或手动添加障碍物。

1. 在APP首页，点击 ![](/images/media/image7.png) 进入【选择地图】功能界面，点击右侧【编辑】按钮，进入【编辑地图】功能界面

2. 选择【编辑障碍物】，进入【编辑障碍物】主界面
   ![编辑障碍物](/images/media/image21.png)

3. 左侧选项可手动添加障碍物、清除障碍物、添加未知区域：
   - 点击添加障碍物，标点功能亮起
   - 把黑色图钉移动到需要添加障碍物的地方，点击【标点】
   - 标点完成后，点击【完成】按钮
   - 点击【保存】按钮，在地图上显示已添加的障碍物

::: warning 注意
目前不支持同时添加障碍物和清除障碍物，需先添加障碍物保存后，再进行清除障碍物。
在使用3D激光建图完成之后，图中会默认存在路沿，可以使用编辑障碍物功能清除路沿。
::: 